"use strict";function Req_ajax(){$.ajax({data:{info:document.getElementById("operations").innerHTML,type:"post"},url:OL_Action_Root+"/req_cal",dataType:"json",cache:!1,timeout:5e3,type:"post",success:function(e){var n=e;"success"==n[0]?(document.getElementById("number").innerHTML=n[1],clearOverflow()):"NaN"==n[0]?document.getElementById("number").innerHTML=NaN:document.getElementById("number").innerHTML="INVALID"},error:function(e,n,i){document.getElementById("number").innerHTML="TIMEOUT",alert("Timeout! Please check your network connection!")}})}function autoFill(){for(var e=document.getElementById("operations");isFunc>0;--isFunc)e.innerHTML+=")";tempOpr="",oriOpr=""}function clearFunc(){(isPow||isFunc>0||isLev)&&(isPow=!1,isFunc=0,isRot||(document.getElementById("operations").innerHTML=oriOpr),tempOpr=tempPow=oriOpr="")}function rootSolve(){isRot=!1,document.getElementById("operations").innerHTML+=document.getElementById("number").innerHTML+")"}function expSolve(){var e=document.getElementById("number"),n=document.getElementById("operations");"-"==e.innerHTML.charAt(0)?n.innerHTML+=e.innerHTML+")":n.innerHTML+="+"+e.innerHTML+")",isExp=!1}function input(e){var n=document.getElementById("number"),i=document.getElementById("operations");if(isNaN(e))switch(e){case"C":i.innerHTML="",n.innerHTML="0",tempOpr="",tempPow="",oriOpr="",isFunc=isLev=0,isNew=isEnd=isExp=isPow=isDeg=isRot=!1,isOpr=!0,clearOverflow();break;case"CE":n.innerHTML="0",isDeg=isExp=!1,clearOverflow(),isEnd&&(i.innerHTML="",isEnd=!1);break;case"Del":if(isFunc){tempOpr=tempOpr.substr(tempOpr.indexOf("(")+1),i.innerHTML=oriOpr+tempOpr,0==--isFunc&&(i.innerHTML=oriOpr,tempOpr="");break}if(isPow){i=oriOpr,isPow=!1;break}if(isDeg){n.innerHTML=n.innerHTML.substr(0,n.innerHTML.length-4)+"deg","deg"==n.innerHTML&&(n.innerHTML="0deg");break}oriOpr="",n.innerHTML=Math.trunc(n.innerHTML/10),"NaN"==n.innerHTML&&(n.innerHTML="0"),n.innerHTML.includes("e")&&(n.innerHTML="0"),clearOverflow(),isEnd&&(i.innerHTML="",isEnd=!1);break;case".":if((isPow||isFunc>0)&&(isPow=!1,isFunc=0,i=oriOpr),isEnd&&(i.innerHTML="",isEnd=!1),n.innerHTML.includes("."))break;n.innerHTML+=".",isNew=!1;break;case"±":clearFunc(),isEnd&&(i.innerHTML="",isEnd=!1),isDeg&&(n.innerHTML=n.innerHTML.substr(0,n.innerHTML.length-3)),n.innerHTML=n.innerHTML.substr(0,n.innerHTML.length-isLev),"π"==n.innerHTML?n.innerHTML="-π":"-π"==n.innerHTML?n.innerHTML="π":n.innerHTML=-n.innerHTML;for(var r=0;r<isLev;++r)n.innerHTML+="!";isDeg&&(n.innerHTML+="deg"),isNew=!1;break;case"=":if(isEnd)break;try{0!=isFunc||isPow||!isOpr||isExp||isRot||(i.innerHTML+=n.innerHTML),isExp&&expSolve(),isRot&&rootSolve(),autoFill(),Req_ajax(),i.innerHTML+=e}catch(e){clearOverflow(),n.innerHTML="INVALID"}isNew=isEnd=isPow=isExp=isDeg=isLev=isRot=!1,isOpr=!0;break;case"(":isEnd&&(i.innerHTML="",isEnd=!1),i.innerHTML+=e;break;case")":isEnd&&(i.innerHTML="",isEnd=!1),isOpr=!1,0!=isFunc||isLev||isPow||(i.innerHTML+=n.innerHTML,isDeg=!1,isNew=!0),i.innerHTML+=")";break;case"10^x":case"e^x":e=e.substr(0,e.length-1);case"sin":case"asin":case"cos":case"acos":case"log":case"ln":case"tan":case"atan":if(isEnd&&(i.innerHTML="",isEnd=!1),!isOpr)break;if(isExp)break;isRot&&rootSolve(),""==tempOpr&&(""==oriOpr&&(oriOpr=i.innerHTML),tempOpr=n.innerHTML),tempOpr=e+"("+tempOpr,i.innerHTML=oriOpr+tempOpr,++isFunc,isNew=!0;break;case"deg":if(isEnd&&(i.innerHTML="",isEnd=!1),isExp)break;clearFunc(),isDeg?(n.innerHTML=n.innerHTML.substr(0,n.innerHTML.length-3),isDeg=!1):(n.innerHTML+="deg",isDeg=!0);break;case"√":e="x^(1/2)";case"1/x":"1/x"==e&&(e="x^(-1)");case"x^2":case"x^3":if(isEnd&&(i.innerHTML="",isEnd=!1),isExp)break;autoFill(),e=e.substr(1),""==oriOpr&&(oriOpr=i.innerHTML),!isPow&&0==isFunc&&isOpr&&(i.innerHTML+=n.innerHTML,tempPow+=n.innerHTML),isPow=!0,i.innerHTML+=e,tempPow+=e,isNew=!0;break;case"n!":if(isEnd&&(i.innerHTML="",isEnd=!1),isExp)break;clearFunc(),isDeg&&(n.innerHTML=n.innerHTML.substr(0,n.innerHTML.length-3)),n.innerHTML+="!",++isLev,isDeg&&(n.innerHTML+="deg"),isNew=!1;break;case"Exp":if(clearFunc(),isExp)break;n.innerHTML=n.innerHTML.replace(/deg/g,""),n.innerHTML=n.innerHTML.replace(/!/g,""),isDeg=!1,isExp=!0,isLev=0,isNew=!0,i.innerHTML+="("+n.innerHTML,n.innerHTML.includes(".")||(i.innerHTML+="."),i.innerHTML+="e";break;case"π":if(isExp)break;clearFunc(),isDeg=!1,isLev=0,isNew=!0,isEnd=!1,n.innerHTML="π";break;case"y√x":autoFill(),isPow||isRot||!isOpr?isRot&&rootSolve():i.innerHTML+=n.innerHTML,n.innerHTML=n.innerHTML.substr(0,n.innerHTML.length-3*isDeg),isDeg=!1,isRot=!0,isLev=0,isNew=!0,i.innerHTML+="^(1/";break;case"x^y":e="^";default:isEnd&&(i.innerHTML="",isEnd=!1);var s=isFunc;autoFill(),s>0||isExp||isPow||!isOpr||(i.innerHTML+=n.innerHTML),isExp&&expSolve(),isRot&&rootSolve(),i.innerHTML+=e,isNew=!0,isPow=!1,isDeg=!1,isLev=!1,isOpr=!0}else{if(clearFunc(),isEnd&&(i.innerHTML="",isEnd=!1),"0"==n.innerHTML||isNew)return n.innerHTML=e,clearOverflow(),void(isNew=!1);isDeg&&(n.innerHTML=n.innerHTML.substr(0,n.innerHTML.length-3)),n.innerHTML=n.innerHTML.substr(0,n.innerHTML.length-isLev),n.innerHTML+=e;for(var t=0;t<isLev;++t)n.innerHTML+="!";isDeg&&(n.innerHTML+="deg"),clearOverflow()}}var isNew=!1,isEnd=!1,isFunc=0,isPow=!1,isExp=!1,isDeg=!1,isLev=0,isOpr=!0,isRot=!1,tempOpr="",tempPow="",oriOpr="",OL_Action_Root="http://127.0.0.1:8888",clearOverflow=function(){var e=document.getElementById("number"),n=140;do{e.style.fontSize=(n/=1.2)+"pt"}while(e.scrollWidth>e.clientWidth||e.scrollHeight>e.clientHeight)};